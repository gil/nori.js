/*
* nori.js v0.0.1 - 2012-08-30 - https://github.com/gil/nori.js
* by Andr√© Gil (http://andregil.net/)
*
* Licensed under:
*    MIT - http://www.opensource.org/licenses/MIT
*/
(function(a,b,c){var d,e,f,g,h;d=function(){function a(){}return a.before=function(b,c,d){var e;return e=b[c],b[c]=function(){var b;return b=a._prepareArgs({method:c},arguments),d.apply(this,b),e.apply(this,arguments)}},a.after=function(b,c,d){var e;return e=b[c],b[c]=function(){var b;return b=a._prepareArgs({method:c},arguments),e.apply(this,arguments),d.apply(this,b)}},a.afterThrow=function(b,c,d){var e;return e=b[c],b[c]=function(){var b;try{return e.apply(this,arguments)}catch(f){return b=a._prepareArgs({method:c,exception:f},arguments),d.apply(this,b)}}},a.afterFinally=function(b,c,d){var e;return e=b[c],b[c]=function(){var b;try{return e.apply(this,arguments)}finally{b=a._prepareArgs({method:c},arguments),d.apply(this,b)}}},a.around=function(b,c,d){var e;return e=b[c],b[c]=function(){var b,f,g=this;return f=arguments,b=a._prepareArgs({method:c,arguments:f,invoke:function(){return e.apply(g,f)}},arguments),d.apply(this,b)}},a.introduction=function(b,c,d){return b[c]=function(){var b;return b=a._prepareArgs({method:c},arguments),d.apply(this,b)}},a._prepareArgs=function(a,b){var c,d,e,f;d=[a];for(e=0,f=b.length;e<f;e++)c=b[e],d.push(c);return d},a}(),f=["before","after","afterThrow","afterFinally","around","introduction"];for(g=0,h=f.length;g<h;g++)e=f[g],d.around(d,e,function(a,b,c,d){var e,f;if(c instanceof RegExp){f=[];for(e in b)e.match(c)?(a.arguments[1]=e,f.push(a.invoke())):f.push(void 0);return f}return a.invoke()});var i;i=function(){function c(){this.beans=[],this.instances={}}var b;return c.prototype.addBeans=function(a){var b,c,d,e;e=[];for(c=0,d=a.length;c<d;c++)b=a[c],e.push(this.addBean(b));return e},c.prototype.addBean=function(a){var b,c;return b=this._beanByName(a.name),b&&(c=this.beans.indexOf(b),this.beans.splice(c,1)),this.beans.push(a)},c.prototype.instance=function(a){var b,c,d;return b=this._beanByName(a),d=!1,c=null,b&&b.type&&(b.singleton===!1?(c=this._proxifyClass(b.type),d=!0):this.instances[a]?c=this.instances[a]:(c=this.instances[a]=this._proxifyClass(b.type),d=!0)),c&&d&&(this._applyConstructor(c,b),this._injectProperties(c,b),this._readAdvices(c,b)),c},c.prototype._injectProperties=function(a,b){var c,d,e,f,g,h,i,j,k;if(b.properties instanceof Array){h=b.properties,j=[];for(f=0,g=h.length;f<g;f++)d=h[f],j.push(a[d]=this.instance(d));return j}if(b.properties instanceof Object){i=b.properties,k=[];for(e in i)c=i[e],k.push(a[e]=this.instance(c));return k}},c.prototype._readAdvices=function(a,b){var c,e,f,g,h;if(b.advices){g=b.advices,h=[];for(e=0,f=g.length;e<f;e++)c=g[e],h.push(d[c.type](a,c.method,this.instance(c.handler)[c.handlerMethod]));return h}},c.prototype.BeanProxy=function(){},c.prototype._proxifyClass=function(a){return this.BeanProxy.prototype=a.prototype,new this.BeanProxy},c.prototype._applyConstructor=function(a,b){var c,d,e,f,g;d=[];if(b.constructor){g=b.constructor;for(e=0,f=g.length;e<f;e++)c=g[e],d.push(this.instance(c))}return b.type.apply(a,d)},c.prototype._beanByName=function(a){var b,c,d,e,f;c=null,f=this.beans;for(d=0,e=f.length;d<e;d++)b=f[d],b.name===a&&(c=b);return c},c.AOP=d,b=a.Nori,a.Nori=c,c.noConflict=function(){return a.Nori=b,c},c}()})(this,document);